import { expect } from '@jest/globals';
import { installSnap } from '@metamask/snaps-jest';
import { copyable, divider, panel, text } from '@metamask/snaps-sdk';

describe('onTransaction', () => {
  it('should decode the attestation', async () => {
    const { sendTransaction } = await installSnap(/* optional Snap ID */);

    const response = await sendTransaction({
      value: '0x0',
      data: '0xf17325e70000000000000000000000000000000000000000000000000000000000000020f58b8b212ef75ee8cd7e8d803c37c03e0519890502d5e99ee2412aae1456cafe0000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000504174746573746174696f6e7320617265207468652070657266656374204c65676f20626c6f636b7320666f722064657363726962696e67206964656e7469747920616e642072657075746174696f6e2e00000000000000000000000000000000',
      to: '0x4200000000000000000000000000000000000021',
    });

    expect(response).toRender(
      panel([
        text('**Schema**'),
        divider(),
        copyable(
          '0xf58b8b212ef75ee8cd7e8d803c37c03e0519890502d5e99ee2412aae1456cafe',
        ),
        text('​'),
        text('**Recipient**'),
        divider(),
        copyable('0x0000000000000000000000000000000000000000'),
        text('​'),
        text('**Ref UID**'),
        divider(),
        copyable(
          '0x0000000000000000000000000000000000000000000000000000000000000000',
        ),
        text('​'),
        text('**Revocable**'),
        divider(),
        copyable('true'),
        text('​'),
        text('**Data**'),
        divider(),
        text('**statement**'),
        copyable(
          'Attestations are the perfect Lego blocks for describing identity and reputation.',
        ),
      ]),
    );
  });
});
